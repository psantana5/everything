import re
import smtplib
from email.mime.text import MIMEText
from datetime import datetime
import os

# Set the path to the Windows event log folder
log_folder = 'C:\\Windows\\System32\\winevt\\Logs\\'

# Get a list of all the event log files in the folder
log_files = os.listdir(log_folder)

# Create a list of suspicious activity patterns
suspicious_patterns = ['password', 'admin', 'root', 'hack', 'attack', 'malware', 'trojan', 'virus', 'vulnerability']

# Create a dictionary to store the count of each pattern found
suspicious_counts = {}
for pattern in suspicious_patterns:
    suspicious_counts[pattern] = 0

# Search for suspicious patterns in the log files
suspicious_logs = []
for log_file in log_files:
    with open(log_folder + log_file, 'r') as f:
        logs = f.readlines()
    for log in logs:
        for pattern in suspicious_patterns:
            if re.search(pattern, log, re.IGNORECASE):
                suspicious_logs.append(log)
                suspicious_counts[pattern] += 1
                break

# If suspicious activity is found, print the logs and counts, and send an email notification
if suspicious_logs:
    print('Suspicious activity was found in the following logs:')
    for log in suspicious_logs:
        print(log)
    print('Counts of suspicious activity:')
    for pattern, count in suspicious_counts.items():
        print(f'{pattern}: {count}')
    
    # Send an email notification
    sender = 'sender@example.com'
    recipient = 'recipient@example.com'
    subject = 'Suspicious activity detected'
    body = f'Suspicious activity was detected in the logs at {datetime.now()}. Please investigate.'
    msg = MIMEText(body)
    msg['Subject'] = subject
    msg['From'] = sender
    msg['To'] = recipient
    s = smtplib.SMTP('localhost')
    s.sendmail(sender, [recipient], msg.as_string())
    s.quit()
else:
    print('No suspicious activity was found in the logs.')